last time for tonight.
Modified from linux.
Modified from Windows.
One more change from Linux.


